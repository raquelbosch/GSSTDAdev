<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Gene selection and filter function — gene_selection • GSSTDAdev</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Gene selection and filter function — gene_selection"><meta property="og:description" content="Gene selection and calculation of filter function values.
After fitting a Cox proportional hazard model to each gene, this function
makes a selection of genes according to their relationship with survival.
Subsequently, with the genes selected, the values of the filtering functions
are calculated for each patient. The filter function allows to summarise each
vector of each individual in a single data. Specifically, it computes a
multivariate Cox proportional hazard model using all previously selected
genes as predictor variables. Subsequently, it calculates for each patient
using this model their linear predictor, which corresponds to the exponent
of their proportionality constant.
Finally, this function selects the genes,
i.e. the columns, from the disease component matrix that will be used as
input data for the mapper algorithm based on the selected criteria."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GSSTDAdev</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/GSSTDA-vignette.html">GSSTDA Vignette: Gene Structure Survival using Topological Data Analysis</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Gene selection and filter function</h1>

    <div class="hidden name"><code>gene_selection.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Gene selection and calculation of filter function values.
After fitting a Cox proportional hazard model to each gene, this function
makes a selection of genes according to their relationship with survival.
Subsequently, with the genes selected, the values of the filtering functions
are calculated for each patient. The filter function allows to summarise each
vector of each individual in a single data. Specifically, it computes a
multivariate Cox proportional hazard model using all previously selected
genes as predictor variables. Subsequently, it calculates for each patient
using this model their linear predictor, which corresponds to the exponent
of their proportionality constant.
Finally, this function selects the genes,
i.e. the columns, from the disease component matrix that will be used as
input data for the mapper algorithm based on the selected criteria.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gene_selection</span><span class="op">(</span></span>
<span>  <span class="va">data_object</span>,</span>
<span>  <span class="va">survival_time</span>,</span>
<span>  <span class="va">survival_event</span>,</span>
<span>  gene_select_surv_type <span class="op">=</span> <span class="st">"Top_Bot"</span>,</span>
<span>  percent_gen_select_for_fun_filt <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  gene_select_mapper_metric <span class="op">=</span> <span class="st">"mad"</span>,</span>
<span>  percent_gen_select_for_mapper <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data-object">data_object<a class="anchor" aria-label="anchor" href="#arg-data-object"></a></dt>
<dd><p>A dsga_object or an object with:</p><ul><li><p>full_data Input matrix whose columns correspond to the patients and
rows to the genes.</p></li>
<li><p>case_tag Character vector of the same length as the number of
columns of <code>full_data</code>. Patients must be in the same order as in
<code>full_data</code>. It must be indicated for each patient whether its
sample is from pathological or healthy tissue. One value should be used to
indicate whether the patient's sample is healthy and another value should
be used to indicate whether the patient's sample is pathological.
The user will then be asked which one indicates whether the patient is
healthy. Only two values are valid in the vector in total.</p></li>
</ul></dd>


<dt id="arg-survival-time">survival_time<a class="anchor" aria-label="anchor" href="#arg-survival-time"></a></dt>
<dd><p>Numerical vector of the same length as the number of
columns of <code>full_data</code>. In addition, the patients must be in the same
order as in <code>full_data</code>. For the patients whose sample is pathological
should be indicated the time between the disease diagnosis and event
(death, relapse or other). If the event has not occurred, it should be
indicated the time until the end of follow-up. Patients whose sample is
from healthy tissue must have an NA value</p></dd>


<dt id="arg-survival-event">survival_event<a class="anchor" aria-label="anchor" href="#arg-survival-event"></a></dt>
<dd><p>Numerical vector of the same length as the number of
columns of <code>full_data</code>. Patients must be in the same order as in
<code>full_data</code>. For the the patients with pathological sample should
be indicated whether the event has occurred (1) or not (0). Only these
values are valid and healthy patients must have an NA value.</p></dd>


<dt id="arg-gene-select-surv-type">gene_select_surv_type<a class="anchor" aria-label="anchor" href="#arg-gene-select-surv-type"></a></dt>
<dd><p>Option. Options on how to select the genes to be
used in the calculation of the values of the filter function (and in the gene
selection for Mapper if the option "sd_surv" has been chosen) Select the
"Abs" option, which means that the genes with the highest absolute value are
chosen, or the "Top_Bot" option, which means that half of the selected
genes are those with the highest value (positive value, i.e.
worst survival prognosis) and the other half are those with the
lowest value (negative value, i.e. best prognosis). "Top_Bot" default option.</p></dd>


<dt id="arg-percent-gen-select-for-fun-filt">percent_gen_select_for_fun_filt<a class="anchor" aria-label="anchor" href="#arg-percent-gen-select-for-fun-filt"></a></dt>
<dd><p>Percentage (from zero to one hundred)
of genes to be selected to be used in the calculation of the values of the
filter function. 1 default option.</p></dd>


<dt id="arg-gene-select-mapper-metric">gene_select_mapper_metric<a class="anchor" aria-label="anchor" href="#arg-gene-select-mapper-metric"></a></dt>
<dd><p>Gene selection criteria for Mapper. Choose as
selection criteria between:</p><ul><li><p>"mad": those genes in the disease component matrix with the highest mean
absolute deviation will be selected</p></li>
<li><p>"sd": those genes with the highest standard deviation will be selected</p></li>
<li><p>“iqr": those genes with the highest interquartile range will be selected</p></li>
<li><p>"mean_sd": to choose genes with high mean and standard deviation simultaneously</p></li>
<li><p>"sd_surv": these option selects genes for mapper based on the product of standard
deviation of the genes in the disease component matrix plus one times
the Z score obtained by fitting a cox proportional hazard model to the level
of each gene. "mad" default option.</p></li>
</ul></dd>


<dt id="arg-percent-gen-select-for-mapper">percent_gen_select_for_mapper<a class="anchor" aria-label="anchor" href="#arg-percent-gen-select-for-mapper"></a></dt>
<dd><p>Percentage (from zero to one hundred)
of genes to be selected to be used in Mapper. 5 default option.</p></dd>


<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p><code>logical</code>. If <code>TRUE</code>, <code>NA</code> rows are omitted.
If <code>FALSE</code>, an error occurs in case of <code>NA</code> rows. TRUE default
option.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>gene_selection_object</code>. It contains:</p><ul><li><p>the matrix with which the gene selection has been performed without NAN's
values (<code>data</code>). It is the <code>matrix_disease_component</code> in case it has been
performed from a <code>dsga_object</code> or <code>full_data</code> in the opposite case.</p></li>
<li><p>the <code>cox_all_matrix</code> (a matrix with the results of the application of
proportional hazard models: with the regression coefficients, the odds ratios,
the standard errors of each coefficient, the Z values (coef/se_coef) and
the p-values for each Z value)</p></li>
<li><p>a vector with the name of the selected genes for mapper
(<code>genes_selected_mapper</code>) and for the calculation of the values of the
filter function (<code>genes_selected_fun_filt</code>).</p></li>
<li><p><code>case_genes_disease_component</code>: the matrix of disease components with
only the rows of the selected genes and only the columns of the pathological
(case) samples. This matrix is one of the inputs for the <code>mapper</code> function.</p></li>
<li><p>and the vector of the values of the filter function of pathological samples
<code>filter_values</code>.</p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">data_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"full_data"</span> <span class="op">=</span> <span class="va">full_data</span>, <span class="st">"case_tag"</span> <span class="op">=</span> <span class="va">case_tag</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">data_object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"data_object"</span></span></span>
<span class="r-in"><span><span class="va">gene_selection_obj</span> <span class="op">&lt;-</span> <span class="fu">gene_selection</span><span class="op">(</span><span class="va">data_object</span>, <span class="va">survival_time</span>,</span></span>
<span class="r-in"><span><span class="va">survival_event</span>, gene_select_surv_type <span class="op">=</span><span class="st">"top_bot"</span>,</span></span>
<span class="r-in"><span>percent_gen_select_for_fun_filt<span class="op">=</span><span class="fl">1</span>, gene_select_mapper_metric<span class="op">=</span><span class="st">"mad"</span>,</span></span>
<span class="r-in"><span>percent_gen_select_for_mapper<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="co"># }</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Are the columns of the data set the patient and the rows the genes?: yes/no </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 0  missing values and NaN's are omitted in the genes (rows)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> What is the tag of the healthy patient (value in the case_tag)? (NT or T): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The case tag is ' NT ' by default"</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> BLOCK II: The gene selection is started</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating the matrix of Zcox</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |==                                                                    |   4%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |================                                                      |  24%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |===================================================                   |  74%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |==========================================================            |  84%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> BLOCK II: The gene selection is finished</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Miriam Esteve, Raquel Bosch, Jaume Forés, Joan Climent, Antonio Falco.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

